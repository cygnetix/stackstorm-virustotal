from __future__ import print_function

import json

from virus_total_apis import PublicApi as VirusTotalPublicApi
from st2common.runners.base_action import Action

test = """{"response_code": 200, "results": {"scan_id": "b35ef2d8a3ee0d29eecb83acf45c1f192ceca75ab10dec861166af2b7bda373b-1541098491", "sha1": "726a2eedb9df3d63ec1b4a7d774a799901f1a2b9", "resource": "726a2eedb9df3d63ec1b4a7d774a799901f1a2b9", "response_code": 1, "scan_date": "2018-11-01 18:54:51", "permalink": "https://www.virustotal.com/file/b35ef2d8a3ee0d29eecb83acf45c1f192ceca75ab10dec861166af2b7bda373b/analysis/1541098491/", "verbose_msg": "Scan finished, information embedded", "sha256": "b35ef2d8a3ee0d29eecb83acf45c1f192ceca75ab10dec861166af2b7bda373b", "positives": 0, "total": 56, "md5": "998a38ee3e5d17dd1081fcd96ee81342", "scans": {"Bkav": {"detected": false, "version": "1.3.0.9898", "result": null, "update": "20181101"}, "MicroWorld-eScan": {"detected": false, "version": "14.0.297.0", "result": null, "update": "20181101"}, "CMC": {"detected": false, "version": "1.1.0.977", "result": null, "update": "20181101"}, "CAT-QuickHeal": {"detected": false, "version": "14.00", "result": null, "update": "20181031"}, "McAfee": {"detected": false, "version": "6.0.6.653", "result": null, "update": "20181101"}, "Malwarebytes": {"detected": false, "version": "2.1.1.1115", "result": null, "update": "20181101"}, "AegisLab": {"detected": false, "version": "4.2", "result": null, "update": "20181101"}, "TheHacker": {"detected": false, "version": "6.8.0.5.3804", "result": null, "update": "20181031"}, "K7GW": {"detected": false, "version": "11.9.28899", "result": null, "update": "20181101"}, "K7AntiVirus": {"detected": false, "version": "11.9.28899", "result": null, "update": "20181101"}, "Arcabit": {"detected": false, "version": "1.0.0.833", "result": null, "update": "20181101"}, "Baidu": {"detected": false, "version": "1.0.0.2", "result": null, "update": "20181101"}, "NANO-Antivirus": {"detected": false, "version": "1.0.134.24299", "result": null, "update": "20181101"}, "F-Prot": {"detected": false, "version": "4.7.1.166", "result": null, "update": "20181101"}, "Symantec": {"detected": false, "version": "1.8.0.0", "result": null, "update": "20181101"}, "ESET-NOD32": {"detected": false, "version": "18311", "result": null, "update": "20181101"}, "TrendMicro-HouseCall": {"detected": false, "version": "10.0.0.1040", "result": null, "update": "20181101"}, "Avast": {"detected": false, "version": "18.4.3895.0", "result": null, "update": "20181101"}, "ClamAV": {"detected": false, "version": "0.100.2.0", "result": null, "update": "20181101"}, "Kaspersky": {"detected": false, "version": "15.0.1.13", "result": null, "update": "20181101"}, "BitDefender": {"detected": false, "version": "7.2", "result": null, "update": "20181101"}, "Babable": {"detected": false, "version": "9107201", "result": null, "update": "20180918"}, "SUPERAntiSpyware": {"detected": false, "version": "5.6.0.1032", "result": null, "update": "20181031"}, "Rising": {"detected": false, "version": "25.0.0.24", "result": null, "update": "20181101"}, "Ad-Aware": {"detected": false, "version": "3.0.5.370", "result": null, "update": "20181101"}, "Emsisoft": {"detected": false, "version": "2018.4.0.1029", "result": null, "update": "20181101"}, "F-Secure": {"detected": false, "version": "11.0.19100.45", "result": null, "update": "20181101"}, "DrWeb": {"detected": false, "version": "7.0.33.6080", "result": null, "update": "20181101"}, "Zillya": {"detected": false, "version": "2.0.0.3682", "result": null, "update": "20181101"}, "TrendMicro": {"detected": false, "version": "10.0.0.1040", "result": null, "update": "20181101"}, "McAfee-GW-Edition": {"detected": false, "version": "v2017.3010", "result": null, "update": "20181101"}, "Sophos": {"detected": false, "version": "4.98.0", "result": null, "update": "20181101"}, "Ikarus": {"detected": false, "version": "0.1.5.2", "result": null, "update": "20181101"}, "Cyren": {"detected": false, "version": "6.0.0.4", "result": null, "update": "20181101"}, "Jiangmin": {"detected": false, "version": "16.0.100", "result": null, "update": "20181101"}, "Avira": {"detected": false, "version": "8.3.3.6", "result": null, "update": "20181101"}, "Fortinet": {"detected": false, "version": "5.4.247.0", "result": null, "update": "20181101"}, "Antiy-AVL": {"detected": false, "version": "3.0.0.1", "result": null, "update": "20181101"}, "Kingsoft": {"detected": false, "version": "2013.8.14.323", "result": null, "update": "20181101"}, "Microsoft": {"detected": false, "version": "1.1.15400.4", "result": null, "update": "20181101"}, "ViRobot": {"detected": false, "version": "2014.3.20.0", "result": null, "update": "20181101"}, "ZoneAlarm": {"detected": false, "version": "1.0", "result": null, "update": "20181101"}, "Avast-Mobile": {"detected": false, "version": "181101-02", "result": null, "update": "20181101"}, "AhnLab-V3": {"detected": false, "version": "3.13.1.22397", "result": null, "update": "20181101"}, "ALYac": {"detected": false, "version": "1.1.1.5", "result": null, "update": "20181101"}, "AVware": {"detected": false, "version": "1.6.0.52", "result": null, "update": "20180925"}, "TACHYON": {"detected": false, "version": "2018-11-01.02", "result": null, "update": "20181101"}, "VBA32": {"detected": false, "version": "3.33.0", "result": null, "update": "20181101"}, "Zoner": {"detected": false, "version": "1.0", "result": null, "update": "20181101"}, "Tencent": {"detected": false, "version": "1.0.0.1", "result": null, "update": "20181101"}, "Yandex": {"detected": false, "version": "5.5.1.3", "result": null, "update": "20181101"}, "MAX": {"detected": false, "version": "2018.9.12.1", "result": null, "update": "20181101"}, "GData": {"detected": false, "version": "A:25.19177B:25.13572", "result": null, "update": "20181101"}, "AVG": {"detected": false, "version": "18.4.3895.0", "result": null, "update": "20181101"}, "Panda": {"detected": false, "version": "4.6.4.2", "result": null, "update": "20181101"}, "Qihoo-360": {"detected": false, "version": "1.0.0.1120", "result": null, "update": "20181101"}}}}
"""

class CheckHash(Action):
    def run(self, file_hash):
        #api_key = self.config['api_key']
        #
        #vt = VirusTotalPublicApi(api_key)
        #response = vt.get_file_report(file_hash)
        #
        ## if VT has no record, we want to add results and totals fields
        #if response.get('results').get('scan_id') == None:
        #    return False

        response = json.loads(test)
        return response
