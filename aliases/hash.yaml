---
name: "check_hash"
pack: "virustotal"
action_ref: "virustotal.check_hash"
description: "Submits a file hash to virustotal.com and displays the number of positive vendor detections"
formats:
  - "vt hash {{file_hash}}"
result:
  format: |
    {%- if execution.status == 'succeeded' -%}
    Detections: {{ execution.result.result.results.positives|default(0) }}
    Scan date: {{ execution.result.result.results.scan_date|default('-') }}
    {{ execution.result.result.results.permalink|default('*No results found*') }}
    {%- else -%}
    ```{{ execution.result.stderr }}```
    {%- endif -%}
  extra:
    slack:
      color: >-
        {%- if execution.result.result.results.positives|default(0) == 0 -%}
        good
        {%- else -%}
        danger
        {%- endif -%}
